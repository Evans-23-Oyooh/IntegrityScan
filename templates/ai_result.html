{% extends 'base.html' %}

{% block title %}AI Detection Results - TextAnalyzer Pro{% endblock %}

{% block content %}
<style>
    .result-header { margin-bottom: 30px; }
    .result-header h1 { color: #1a1a1a; font-weight: 700; font-size: 32px; margin-bottom: 10px; }
    .score-card { background: white; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .score-display { text-align: center; }
    .score-number { font-size: 64px; font-weight: 900; margin: 20px 0; }
    .score-number.ai { color: #f59e0b; }
    .score-number.human { color: #10b981; }
    .score-label { font-size: 16px; color: #666; font-weight: 600; }
    .score-status { font-size: 18px; font-weight: 700; margin-top: 15px; padding: 12px; border-radius: 8px; }
    .status-ai { background: #fef3c7; color: #92400e; }
    .status-human { background: #e6f4ea; color: #137333; }
    .progress-bar-custom { height: 30px; background: #e5e5e5; border-radius: 8px; overflow: hidden; margin: 15px 0; }
    .progress-fill { height: 100%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px; }
    .fill-ai { background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%); }
    .fill-human { background: linear-gradient(90deg, #10b981 0%, #059669 100%); }
    .details-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    .detail-item { background: #f8f9fa; padding: 15px; border-radius: 8px; }
    .detail-label { font-size: 12px; color: #999; text-transform: uppercase; font-weight: 600; margin-bottom: 8px; }
    .detail-value { font-size: 24px; font-weight: 700; color: #1a1a1a; }
    .text-preview { background: #f8f9fa; padding: 15px; border-radius: 8px; max-height: 250px; overflow-y: auto; font-size: 13px; color: #666; line-height: 1.6; }
    .btn-new-check { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; display: inline-block; transition: all 0.3s; }
    .btn-new-check:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16,185,129,0.3); color: white; }
    @media (max-width: 768px) {
        .score-number { font-size: 48px; }
        .details-grid { grid-template-columns: 1fr; }
    }
</style>

<div class="result-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h1>ü§ñ AI Detection Results</h1>
            <p style="color: #666; margin: 0;">Analysis completed successfully</p>
        </div>
        <a href="{% url 'ai_detection' %}" class="btn-new-check">+ New Analysis</a>
    </div>
</div>

<!-- Score Card -->
<div class="score-card">
    <div class="score-display">
        <div class="score-label">AI Probability Score</div>
        <div class="score-number {% if detection.is_ai_generated %}ai{% else %}human{% endif %}">
            {{ detection.ai_probability|floatformat:1 }}%
        </div>
        <div class="progress-bar-custom">
            <div class="progress-fill {% if detection.is_ai_generated %}fill-ai{% else %}fill-human{% endif %}" 
                 style="width: {{ detection.ai_probability|floatformat:0 }}%;">
                {{ detection.ai_probability|floatformat:1 }}%
            </div>
        </div>
        <div class="score-status {% if detection.is_ai_generated %}status-ai{% else %}status-human{% endif %}">
            {% if detection.is_ai_generated %}
                ‚ö†Ô∏è AI-Generated Content Detected
            {% else %}
                ‚úì Human-Written Content
            {% endif %}
        </div>
    </div>

    <div class="details-grid">
        <div class="detail-item">
            <div class="detail-label">Confidence Level</div>
            <div class="detail-value" style="color: {% if detection.ai_probability > 0.8 %}#ef4444{% elif detection.ai_probability > 0.6 %}#f59e0b{% elif detection.ai_probability > 0.4 %}#3b82f6{% else %}#10b981{% endif %};">
                {% if detection.ai_probability > 0.8 %}Very High{% elif detection.ai_probability > 0.6 %}High{% elif detection.ai_probability > 0.4 %}Medium{% else %}Low{% endif %}
            </div>
        </div>
        <div class="detail-item">
            <div class="detail-label">Text Length</div>
            <div class="detail-value">{{ detection.text|length }} chars</div>
        </div>
        <div class="detail-item">
            <div class="detail-label">Content Type</div>
            <div class="detail-value" style="color: {% if detection.is_ai_generated %}#f59e0b{% else %}#10b981{% endif %};">
                {% if detection.is_ai_generated %}AI-Generated{% else %}Human{% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Analyzed Text -->
<div class="card shadow-sm" style="margin-bottom: 30px;">
    <div class="card-header bg-white border-bottom">
        <h5 class="mb-0" style="color: #1a1a1a; font-weight: 700;">üìù Analyzed Text</h5>
    </div>
    <div class="card-body">
        <div class="text-preview">
            {{ detection.text|truncatewords:300 }}
        </div>
    </div>
</div>

<!-- Humanized Version (if AI detected) -->
{% if detection.is_ai_generated and detection.humanized_text %}
<div class="card shadow-sm" style="margin-bottom: 30px;">
    <div class="card-header bg-white border-bottom">
        <h5 class="mb-0" style="color: #1a1a1a; font-weight: 700;">‚ú® Humanized Version</h5>
    </div>
    <div class="card-body">
        <div class="text-preview" style="background: #e6f4ea;">
            {{ detection.humanized_text|truncatewords:300 }}
        </div>
        <button class="btn btn-sm" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; margin-top: 15px; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer;" onclick="copyToClipboard('humanized-text')">
            <i class="fas fa-copy me-1"></i>Copy Humanized Text
        </button>
    </div>
</div>
{% endif %}

<!-- Recommendations -->
{% if detection.is_ai_generated %}
<div class="card shadow-sm">
    <div class="card-header bg-white border-bottom">
        <h5 class="mb-0" style="color: #1a1a1a; font-weight: 700;">üí° Recommendations</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 12px;"><i class="fas fa-lightbulb" style="color: #f59e0b; margin-right: 10px;"></i>Use the humanized version for more natural content</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-edit" style="color: #3b82f6; margin-right: 10px;"></i>Add personal experiences and specific examples</li>
                </ul>
            </div>
            <div class="col-md-6">
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 12px;"><i class="fas fa-user-friends" style="color: #10b981; margin-right: 10px;"></i>Include conversational elements and varied sentence structure</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-heart" style="color: #ef4444; margin-right: 10px;"></i>Add emotional context and personal opinions</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="card shadow-sm" style="background: #e6f4ea; border: 2px solid #10b981;">
    <div class="card-body" style="text-align: center; padding: 40px;">
        <i class="fas fa-check-circle" style="font-size: 48px; color: #10b981; margin-bottom: 15px; display: block;"></i>
        <h5 style="color: #137333; margin-bottom: 10px;">Human-Written Content Confirmed</h5>
        <p style="color: #137333; margin: 0;">This content appears to be written by a human with natural language patterns.</p>
    </div>
</div>
{% endif %}

<!-- Action Buttons -->
<div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap;">
    <a href="{% url 'ai_detection' %}" class="btn-new-check">+ Analyze Another Text</a>
    <a href="{% url 'plagiarism_check' %}" style="background: #3b82f6; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; display: inline-block; transition: all 0.3s;">
        üîç Check for Plagiarism
    </a>
</div>

<textarea id="humanized-text" style="position: absolute; left: -9999px;">{{ detection.humanized_text }}</textarea>
{% endblock %}

{% block scripts %}
<script>
function copyToClipboard(elementId) {
    const textArea = document.getElementById(elementId);
    textArea.select();
    document.execCommand('copy');
    
    const btn = event.target;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-check me-1"></i>Copied!';
    btn.style.background = 'linear-gradient(135deg, #059669 0%, #047857 100%)';
    
    setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
    }, 2000);
}
</script>
{% endblock %}